# Отчёт по практической работе №7
## Работа с навигацией в Android

### **BottomNavigationApp**

Было создано приложение `BottomNavigationApp`. 
1. Содано три простых `Blank Fragment`: `HomeFragment`, `DashboardFragment`, `NotificationsFragment` с соответствующими макетами. В каждый макет поместите `TextView` с названием фрагмента.

<img width="303" height="195" alt="image" src="https://github.com/user-attachments/assets/f6eb52b3-fd8c-4cc3-9758-4ffeb139462c" />

```java
@Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        return inflater.inflate(R.layout.fragment_home, container, false);
    }
```

2. Далее реализована разметка меню - `bottom_nav_menu.xml`, необходимые для меню иконки и граф навигации.
3. Макет `MainActivity` содержит `NavHostFragment` и `BottomNavigationView`.
```java
<?xml version="1.0" encoding="utf-8"?>
<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:id="@+id/container"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <fragment
        android:id="@+id/nav_host_fragment_activity_main"
        android:name="androidx.navigation.fragment.NavHostFragment"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        app:defaultNavHost="true"
        app:layout_constraintBottom_toTopOf="@id/nav_view"
        app:layout_constraintLeft_toLeftOf="parent"
        app:layout_constraintRight_toRightOf="parent"
        app:layout_constraintTop_toTopOf="parent"
        app:navGraph="@navigation/mobile_navigation" />

    <com.google.android.material.bottomnavigation.BottomNavigationView
        android:id="@+id/nav_view"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:background="?android:attr/windowBackground"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintLeft_toLeftOf="parent"
        app:layout_constraintRight_toRightOf="parent"
        app:menu="@menu/bottom_nav_menu" />
</androidx.constraintlayout.widget.ConstraintLayout>
```
4. В файле `build.gradle.kts` данного модуля подключен `View Binding`.
```java
buildFeatures {
        viewBinding = true
    }
```
5. В коде `MainActivity` используется `ViewBinding` и `NavigationUI` для автоматической связки.
```java
@Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        binding = ActivityMainBinding.inflate(getLayoutInflater());
        setContentView(binding.getRoot());

        AppBarConfiguration appBarConfiguration = new AppBarConfiguration.Builder(
                R.id.navigation_home, R.id.navigation_dashboard, R.id.navigation_notifications)
                .build();

        NavHostFragment navHostFragment = (NavHostFragment) getSupportFragmentManager()
                .findFragmentById(R.id.nav_host_fragment_activity_main);
        NavController navController = navHostFragment.getNavController();

        NavigationUI.setupActionBarWithNavController(this, navController, appBarConfiguration);
        NavigationUI.setupWithNavController(binding.navView, navController);
    }
```

<img width="200" height="450" alt="image" src="https://github.com/user-attachments/assets/91052c30-4b9a-446d-8521-6c6c9434d024" /> <img width="200" height="450" alt="image" src="https://github.com/user-attachments/assets/7feef85c-6bcb-4c83-9fd4-4948dc9eb9ba" /> 
<img width="200" height="450" alt="image" src="https://github.com/user-attachments/assets/993de86d-b9e2-40e2-8115-3f1e69fbea96" />

### **NavigationDrawerApp**

1. Создан модуль проекта с шаблоном Navigation Drawer Views Activity. Созданный модуль содержит:
- Все необходимые зависимости в build.gradle.
- Cтруктуру XML-макетов (activity_main.xml с DrawerLayout, app_bar_main.xml, content_main.xml, nav_header_main.xml).
- Ресурсы меню (activity_main_drawer.xml).
- Граф навигации (mobile_navigation.xml).
- Готовые фрагменты (HomeFragment, GalleryFragment, SlideshowFragment) с их ViewModel-ами.
- Полностью написанный `MainActivity.java`, который связывает все эти компоненты вместе.

  <img width="200" height="450" alt="image" src="https://github.com/user-attachments/assets/7e4225c1-5cc0-49e6-81cd-6b67f808808a" />

2. Далее, согласно заданию была обновлена цветовая гамма приложения (настроены цвета в `colors.xml`).

   <img width="200" height="450" alt="image" src="https://github.com/user-attachments/assets/2d1542eb-2dd1-49c2-ac17-5c0f6d0094f8" />

4. Изменена шапка шторки - вместо заглушки добавлено ФИО и учебная группа (файл `nav_header_main.xml`).

<img width="200" height="450" alt="image" src="https://github.com/user-attachments/assets/f2db4bb7-ee7e-4af2-9aab-430b82ed0ea5" />

5. Затем следовало изменение пунктов меню в файле `activity_main_drawer.xml`.
6. Обновлен граф навигации.
```java
<fragment
        android:id="@+id/nav_search"
        android:name="ru.mirea.kovalikaa.navdrawerapp.ui.SearchFragment"
        android:label="Поиск"
        tools:layout="@layout/fragment_search" />
    <fragment
        android:id="@+id/nav_favorites"
        android:name="ru.mirea.kovalikaa.navdrawerapp.ui.FavoritesFragment"
        android:label="Избранное"
        tools:layout="@layout/fragment_favorites" />
    <fragment
        android:id="@+id/nav_profile"
        android:name="ru.mirea.kovalikaa.navdrawerapp.ui.ProfileFragment"
        android:label="Профиль"
        tools:layout="@layout/fragment_profile" />
```
7. `AppBarConfiguration` в файле `MainActivity` был отредактирован для обновления информации о новых экранах.
```java
mAppBarConfiguration = new AppBarConfiguration.Builder(
        R.id.nav_search, R.id.nav_favorites, R.id.nav_profile) // <-- ИЗМЕНЕННЫЕ ID
        .setOpenableLayout(drawer)
        .build();
```
8. Для реализации закрытия шторки было переопределено стандартное поведение кнопки "Назад".
Реализовано добавлением обработчика нажатия на кнопку с проверкой состояния шторки. 
```java
getOnBackPressedDispatcher().addCallback(this, new OnBackPressedCallback(true) {
            @Override
            public void handleOnBackPressed() {
                if (binding.drawerLayout.isDrawerOpen(GravityCompat.START)) {
                    binding.drawerLayout.closeDrawer(GravityCompat.START);
                } else {
                    setEnabled(false);
                    MainActivity.super.onBackPressed();
                }
            }
        });
```

<img width="200" height="450" alt="image" src="https://github.com/user-attachments/assets/c9fb5dab-fd24-4fdf-8ea9-b6528c8b7a41" />

### **Контрольное задание**
- Первоначально, в `build.gradle.kts` был внедрен `View Binding`.
```java
buildFeatures {
        viewBinding = true
    }
```
- Далее следовал рефакторинг всех `Activity`.
```java
@Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        binding = ActivityMainBinding.inflate(getLayoutInflater());
        setContentView(binding.getRoot());
```
- Во фрагментах логика иная - в `onCreateView` сначала создаем `binding`, а в `onDestroyView` — обнуляем его, чтобы избежать утечек памяти.
- В новосоданной директории `res/navigation` создан граф навигации `nav_graph.xml`. Далее в него добавлены три фрагмента.
- В `activity_main.xml` следовала замена `FragmentContainerView` на `NavHostFragment`.
- `MainActivity` после рефакторинга содержит простой код, который основан на использовании `NavigationUI`.
```java
public class MainActivity extends AppCompatActivity {
    
    private ActivityMainBinding binding;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        binding = ActivityMainBinding.inflate(getLayoutInflater());
        setContentView(binding.getRoot());

        AppBarConfiguration appBarConfiguration = new AppBarConfiguration.Builder(
                R.id.navigation_search, R.id.navigation_favorites, R.id.navigation_profile)
                .build();
        
        NavHostFragment navHostFragment = (NavHostFragment) getSupportFragmentManager()
                .findFragmentById(R.id.nav_host_fragment);
        NavController navController = navHostFragment.getNavController();

        NavigationUI.setupActionBarWithNavController(this, navController, appBarConfiguration);
        NavigationUI.setupWithNavController(binding.bottomNavigationView, navController);
    }
}
```

<img width="388" height="877" alt="image" src="https://github.com/user-attachments/assets/dcdb2140-520f-42f1-b46a-94acc92c8bcf" /> 
<img width="392" height="879" alt="image" src="https://github.com/user-attachments/assets/451e6634-ef26-4e6d-b5ca-f34ba324c93c" /> 
<img width="390" height="859" alt="image" src="https://github.com/user-attachments/assets/5a4cc09b-9fbc-41f7-8e84-69be7630bfbb" />



